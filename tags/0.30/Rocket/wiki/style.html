<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Style</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" />
</head>

<body>
<h1>Purpose</h1>
<p>
The purpose of the rocket.style package is to expose a standards based view of style properties regardless of the source.
A number of other features are provided to make authoring and working with styles more intuitive, easier with less boiler code. It is advised that the javadoc for the
class be read to learn about more of the features.
</p>

<h1>Features</h1>

<h2>Standards based view of style properties</h2>
<p>
Currently styles may be written to and read using <code>com.google.gwt.user.client.DOM</code> but it does know or handle browser differences.
The list of style properties and values between browsers is quite different and varied as demonstrated by the two contrived examples below.
It is not possible to work with rules, stylesheets without significant effort as abstractions are not currently available in GWT.
</p>

<h3>Opacity example</h3>
<p>
The example below shows how setting opacity might be done using <code>com.google.gwt.user.client.DOM</code>.
When not using Rocket's abstraction notice the special case testing to handle Internet Explorer.
</p>

<pre>
Element element = <b>// get from somewhere...</b>

String value = "opacity=0.5";
<b>// special test for ie</b>
if( browser is ie ){
	value = "alpha(opacity=50)";
}
DOM.setStyleAttribute( element, value );

<b>// skip attempt to include special case to read opacity value for Internet Explorer...This would be quite messy as one would have to extract the number within "alpha(opacity=50)"...</b>
</pre>

<p>
Using Rocket's abstractions <code>rocket.style.client.StyleHelper</code> it is much easier to set the opacity upon an element, and equally easy to read an opacity value.
</p>

<pre>
Element element <b>//get from somewhere...</b>

<b>// Set an opacity value upon element...</b>
StyleHelper.setInlineDoubleStyle( element, "opacity", 0.5 );

<b>// Get the opacity value from element...</b>
double opacity = StyleSheet.getInlineDoubleStyle( element, "opacity", CssUnit.NONE, 1.0 );
</pre>

<h3>Fixed positioning example</h3>
<p>
Unfortunately Internet Explorer does not under position="fixed". The style package emulates it using dynamic expressions.
The sample below shows how it easy it is to give an element a fixed position. It is also equally easy to determine the position value for an element.
</p>

<pre>
Element element <b>//get from somewhere...</b>
StyleHelper.setInlineStyleProperty( element, "position", "fixed" );
StyleHelper.setInlineIntegerStyleProperty( element, "left", 10, CssUnit.PX );
StyleHelper.setInlineIntegerStyleProperty( element, "top", 20, CssUnit.PX  );
</pre>

<h3>Other style properties</h3>
<p>
Internet explorer is not the only culprit, there are a number of other special cases for style properties. Refer to the code to find other special cases.
</p>

<h2>StyleSheets</h2>
<p>
A number of methods are available to help with visiting all the StyleSheets belonging to the current page.
</p>

<h2>Rules</h2>
<p>
Rules may be added, inserted, removed and edited from within a stylesheet. The selector text for a rule may also be dynamically updated.
It is also possible to work with a List view of all the Rules belonging to a single stylesheet.
</p>

<h2>Rule Style Properties</h2>
<p>
Style properties may be added, changed or removed from a rule. It is also possible to work with a Map view of all the Style properties belonging to a Rule.
</p>

<h2>Inline Style Properties</h2>
<p>
It is possible to add, change, remove or read inline style properties belonging to an element. A Map view of all styles is also available.
</p>


<h2>Computed Style Properties</h2>
<p>
It is possible to read the computed style properties belonging to an element. A read only Map view of all styles is also available.
</p>

<h1>Richer style property value types</h1>
The package also supports a richer set of value types on top of boolean, int and String.

<h2>Integer and double values</h2>
<p>
The package includes support for extracting a value seemlessly, converting between unit types. Refer to javadoc for more details.
</p>

<pre>
	StyleHelper.getComputedIntegerProperty(Element element, String propertyName, CssUnit unit, int defaultValue );
	StyleHelper.getComputedDoubleProperty(Element element, String propertyName, CssUnit unit, double defaultValue );

	StyleHelper.getInlineIntegerProperty(Element element, String propertyName, CssUnit unit, int defaultValue );
	StyleHelper.getInlineDoubleProperty(Element element, String propertyName, CssUnit unit, double defaultValue );

	StyleHelper.setInlineIntegerProperty(Element element, String propertyName, int propertyValue, CssUnit unit);
	StyleHelper.setInlineDoubleProperty(Element element, String propertyName, double propertyValue, CssUnit unit );
</pre>

<div class="info">
Some browsers always append a unit when a property was read as a String or require a unit to be specified. The package takes care of all
these sorts of quirks and irritating differences between browsers.
</div>

<h3>Colour values</h3>
<p>
A property such as <code>color</code> or <code>background-color</code> can be written to or read from as a <code>rocket.util.client.Colour</code>.
This class includes many useful features for manipulating colour values.
Refer to javadoc for more details.
</p>
<div class="info">
All browsers represent colours in a different way. Internet Explorer exposes the value (eg a named colour) used to set the property.
Together with <code>rocket.util.client.Colour</code> regardless of the internal format used application code can work in a consist format.
</div>

<pre>
	StyleHelper.getComputedColourProperty(Element element, String propertyName);
	StyleHelper.getInlineDoubleProperty(Element element, String propertyName);
	StyleHelper.setInlineDoubleProperty(Element element, String propertyName);
</pre>

<h1>Getting started</h1>
<p>
The following steps below list what and why is needed to use this facility in your own development efforts.
</p>

<h2>Importing the rocket module</h2>
<p>
Add the rocket module to your own module.
</p>
<pre>
&lt;module name="Rocket.User" /&gt;
</pre>

<h2>Examples</h2>

<h3>Invert colour property values within a StyleSheet</h3>
<p>
This example shows how easy it is to visit and find all the colour style properties within a stylesheet.
After the method runs all properties with the word colour will have their values inverted. This should find and change values for properties such as
<ul>
<li>color</li>
<li>background-color</li>
<li>border-XXX-color where XXX is "top", "right", "bottom" and "left"</li>
</ul>
</p>

<pre>
package example;

import java.util.Iterator;
import java.util.Map.Entry;
import rocket.style.client.StyleHelper;
import rocket.style.client.StyleSheet;
import rocket.style.client.Rule;
import rocket.style.client.StylePropertyValue;
import rocket.util.client.Colour;

public StyleSheetChanger{

	public void invertFirstStyleSheetColoursPropertyValues(){
		final StyleSheet styleSheet = StyleHelper.getStyleSheets().get( 0 );
		final Iterator rules = styleSheet.getRules().iterator();

		<b>// visit all the rules for the first stylesheet</b>
		while( rules.hasNext() ){
			final Rule rule = (Rule) rules.next();

			<b>// visit all the style properties finding those with color in their name...</b>
			final Iterator properties = rules.getStyle().entrySet().iterator();
			while( properties.hasNext() ){
				final Map.Entry property = (Map.Entry) properties.next();
				final String propertyName = (String) property.getKey();

				<b>// if not a color property skip it...</b>
				if( propertyName.toLowerCase().indexOf( "color" ) == -1 ){
					continue;
				}

				<b>// if value isnt present skip...</b>
				final StylePropertyValue propertyValue = (StylePropertyValue) property.getValue();
				if( null == propertyValue ){
					continue;
				}
				final Colour colour = propertyValue.getColour();
				if( null == colour ){
					continue;
				}

				<b>//invert the red, green and blue component...</b>
				colour.setRed( 0xff ^ colour.getRed() );
				colour.setGreen( 0xff ^ colour.getGreen() );
				colour.setBlue( 0xff ^ colour.getBlue() );

				<b>// update the colour...</b>
				propertyValue.setColour( colour );
				properties.setValue( propertyValue );
			}
		}
	}
}

</pre>

<h3>Unit tests</h3>
<p>
For further examples refer to the unit tests that accompany this package.
</p>
<ul>
<li>rocket.style.test.computedstyle.ComputedStyleGwtTestCase</li>
<li>rocket.style.test.inlinestyle.InlineStyleGwtTestCase</li>
<li>rocket.style.test.stylehelper.client.StyleHelperTest</li>
<li>rocket.style.test.stylepropertyvalue.StylePropertyValueGwtTestCase</li>
<li>rocket.style.test.stylesheet.client.StyleSheetTest</li>
</ul>

</body>